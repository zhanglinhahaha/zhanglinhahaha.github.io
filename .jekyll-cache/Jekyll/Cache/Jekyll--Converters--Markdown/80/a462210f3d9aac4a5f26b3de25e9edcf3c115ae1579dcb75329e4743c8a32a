I"Ÿ<h3 id="å¤‡å¿˜å½•æ¨¡å¼">å¤‡å¿˜å½•æ¨¡å¼</h3>
<p>Without violating encapsulation,capture and externalize an objectâ€™s internal state so that the object can be restored to this state later.
(åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹,æ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€,å¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚)</p>
<h3 id="é€šç”¨ç±»å›¾">é€šç”¨ç±»å›¾</h3>
<p>å‘èµ·äººè§’è‰²ç±»
è®°å½•å½“å‰æ—¶åˆ»çš„å†…éƒ¨çŠ¶æ€ï¼Œè´Ÿè´£å®šä¹‰å“ªäº›å±äºå¤‡ä»½èŒƒå›´çš„çŠ¶æ€ï¼Œè´Ÿè´£åˆ›å»ºå’Œæ¢å¤å¤‡å¿˜å½•æ•°æ®
å¤‡å¿˜å½•è§’è‰²ç±»
è´Ÿè´£å­˜å‚¨å‘èµ·äººå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œåœ¨éœ€è¦çš„æ—¶å€™æä¾›å‘èµ·äººéœ€è¦çš„å†…éƒ¨çŠ¶æ€
å¤‡å¿˜å½•ç®¡ç†å‘˜è§’è‰²ç±»
å¯¹å¤‡å¿˜å½•è¿›è¡Œç®¡ç†ã€ä¿å­˜å’Œæä¾›å¤‡å¿˜å½•</p>
<h3 id="é€šç”¨æºç ">é€šç”¨æºç </h3>
<p>//å‘èµ·äººè§’è‰²ç±»
class Originator {
public:
    //setå’Œget
    string getState() { return state; }
    void setState(string s) { state = s; }
    //åˆ›å»ºå¤‡å¿˜å½•
    Memento* createMemento() {
        return new Memento(state);
    }
    //æ¢å¤å¤‡å¿˜å½•
    void restoreMemento(Memento m) {
        setState(m.getState());
    }
private:
    //å†…éƒ¨çŠ¶æ€
    string state;
};
//å¤‡å¿˜å½•è§’è‰²ç±»
class Memento {
public:
    //æ„é€ å‡½æ•°ä¼ é€’å‚æ•°
    Memento(string s) {
        state = s;
    }
    string getState() {
        return state;
    }
    void setState(string s) {
        state = s;
    }
private:
    //å‘èµ·äººçš„å†…éƒ¨çŠ¶æ€
    string state;
};
//å¤‡å¿˜å½•ç®¡ç†å‘˜è§’è‰²ç±»
class Caretaker {
public:
    Memento getMemento() {
        return <em>memento;
    }
    void setMemento(Memento m) {
        memento = &amp;m;
    }
private:
    //å¤‡å¿˜å½•å¯¹è±¡
    Memento</em> memento;
};</p>
<h3 id="ä½¿ç”¨åœºæ™¯">ä½¿ç”¨åœºæ™¯</h3>
<p>éœ€è¦ä¿å­˜å’Œæ¢å¤æ•°æ®çš„ç›¸å…³çŠ¶æ€åœºæ™¯
æä¾›ä¸€ä¸ªå¯å›æ»šçš„æ“ä½œ
éœ€è¦ç›‘æ§çš„å‰¯æœ¬åœºæ™¯ä¸­
æ•°æ®åº“è¿æ¥çš„äº‹åŠ¡ç®¡ç†</p>
<h3 id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹</h3>
<p>å¤‡å¿˜å½•çš„ç”Ÿå‘½æœŸï¼Œè¦ä¸»åŠ¨ç®¡ç†ï¼Œå»ºç«‹å°±è¦ä½¿ç”¨ï¼Œä¸ä½¿ç”¨å°±åˆ é™¤
å¤‡å¿˜å½•çš„æ€§èƒ½ï¼Œä¸è¦åœ¨é¢‘ç¹å»ºç«‹å¤‡ä»½çš„åœºæ™¯ä¸­ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼</p>
<h3 id="æ‰©å±•">æ‰©å±•</h3>
<p>cloneæ–¹å¼çš„å¤‡å¿˜å½•
å¤šçŠ¶æ€çš„å¤‡å¿˜å½•æ¨¡å¼
å¤šå¤‡ä»½çš„å¤‡å¿˜å½•</p>
<h3 id="æœ€ä½³å®è·µ">æœ€ä½³å®è·µ</h3>
<p>å¯ä»¥åˆ©ç”¨å¤‡å¿˜å½•æ¨¡å¼ç»™æ•°æ®åº“å‡å‹</p>
<h3 id="ç¤ºä¾‹ä»£ç ">ç¤ºä¾‹ä»£ç </h3>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#include &lt;iostream&gt;
#include &lt;string&gt;

using namespace std;

class Memento {
public:
    Memento(string s) {
        state = s;
    }
    string getState() {
        return state;
    }
    void setState(string s) {
        state = s;
    }
private:
    string state;
};

class Caretaker {
public:
    Memento getMemento() {
        return *memento;
    }
    void setMemento(Memento m) {
        memento = &amp;m;
    }
private:
    Memento* memento;
};

class Boy {
public:
    void changeState() {
        state = "bad";
    }
    string getState() {
        return state;
    }
    void setState(string s) {
        state = s;
    }
    Memento* createMemento() {
        return new Memento(state);
    }
    void restoreMemento(Memento m) {
        setState(m.getState());
    }
private:
    string state;
};

int main() {
    Boy b;
    Caretaker c;
    b.setState("good");
    cout &lt;&lt; "Before current state: " &lt;&lt; b.getState() &lt;&lt; endl;
    c.setMemento(*(b.createMemento()));
    b.changeState();
    cout &lt;&lt; "After current state: " &lt;&lt; b.getState() &lt;&lt; endl;
    b.restoreMemento(c.getMemento());
    cout &lt;&lt; "Restore current state: " &lt;&lt; b.getState() &lt;&lt; endl;
    return 0;
}
</code></pre></div></div>

:ET